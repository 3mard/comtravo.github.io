<!DOCTYPE html><html lang="en-US"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.5.0 --><title>Async/Await and JavaScript Arrays | Comtravo tech</title><meta name="generator" content="Jekyll v3.8.5" /><meta property="og:title" content="Async/Await and JavaScript Arrays" /><meta name="author" content="Comtravo" /><meta property="og:locale" content="en_US" /><meta name="description" content="Async/Await for JavaScript Array methods" /><meta property="og:description" content="Async/Await for JavaScript Array methods" /><link rel="canonical" href="http://localhost:4000/AsyncRay/" /><meta property="og:url" content="http://localhost:4000/AsyncRay/" /><meta property="og:site_name" content="Comtravo tech" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-01-08T00:00:00+01:00" /> <script type="application/ld+json"> {"description":"Async/Await for JavaScript Array methods","author":{"@type":"Person","name":"Comtravo"},"@type":"BlogPosting","url":"http://localhost:4000/AsyncRay/","headline":"Async/Await and JavaScript Arrays","dateModified":"2019-01-08T00:00:00+01:00","datePublished":"2019-01-08T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/AsyncRay/"},"@context":"http://schema.org"}</script> <!-- End Jekyll SEO tag --><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/icons/apple-touch-icon.png?v=qA3OXqyw77"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/icons/favicon-32x32.png?v=qA3OXqyw77"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/icons/favicon-16x16.png?v=qA3OXqyw77"><link rel="manifest" href="/assets/img/icons/manifest.json?v=qA3OXqyw77"><link rel="mask-icon" href="/assets/img/icons/safari-pinned-tab.svg?v=qA3OXqyw77" color="#5bbad5"> <!--[if IE]><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><![endif]--><link rel="shortcut icon" href="/assets/img/icons/favicon.ico?v=qA3OXqyw77"><meta name="apple-mobile-web-app-title" content="Sleek"><meta name="application-name" content="Sleek"><meta name="msapplication-config" content="/assets/img/icons/browserconfig.xml?v=qA3OXqyw77"><meta name="theme-color" content="#ffffff"><style class="inlineCSS"> h1{color:#313237;margin-top:0;margin-bottom:.5rem}.dark-bg{background-color:#313237}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:last-of-type,.post-card:nth-child(2n+2){margin-right:0}}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}header,nav,section{display:block}h1{font-size:2em;margin:.67em 0}figure,main{display:block}figure{margin:1em 40px}a{background-color:transparent;-webkit-text-decoration-skip:objects}img{border-style:none}svg:not(:root){overflow:hidden}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}body{-webkit-overflow-scrolling:touch}*,::after,::before{-webkit-box-sizing:inherit;box-sizing:inherit}.site{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.site__content{-webkit-box-flex:1;-ms-flex:1;flex:1}img{max-width:100%;height:auto;width:auto;vertical-align:middle}figure{margin:0}body{background-color:#fff;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Hiragino Sans GB","Microsoft YaHei","WenQuanYi Micro Hei",sans-serif;font-size:1rem;line-height:1.5;color:#343851;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%}p{margin-top:0;margin-bottom:1.25rem}h1,h2{color:#313237;margin-top:0;margin-bottom:.5rem}a{color:#277cea;text-decoration:none;border-bottom:1px dashed #277cea}.blur{background:#fff;filter:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg"><filter id="filter"><feGaussianBlur stdDeviation="16" /></filter></svg>#filter');-webkit-filter:blur(1rem);filter:blur(1rem)}.container{padding:0 20px;max-width:100%;margin:0 auto}@media only screen and (min-width:36em){.container{max-width:540px;margin:0 auto}}@media only screen and (min-width:48em){.container{max-width:720px;margin:0 auto}}@media only screen and (min-width:62em){.container{max-width:960px;margin:0 auto}}@media only screen and (min-width:75em){.container{max-width:1170px;margin:0 auto}}.header{background-color:#fff;color:#343851;position:absolute;z-index:4;width:100%;top:0;left:0;will-change:transform;-webkit-transform:translateY(0);transform:translateY(0)}.header a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:0}.header__logo{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;overflow:hidden;padding:19px 0;margin-right:1.25rem;outline:0;border-bottom:0;color:#313237}.header__logo .header__logo--container{width:58px}.header__logo .header__logo--container .logo{fill:currentColor}.header__inner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:3.75em;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__links{padding-bottom:.5rem;display:none;position:absolute;top:3.75em;left:0;width:100%;height:auto;background:#fff}.header__link{color:#343851;padding:.938rem 0;border-top:1px solid #ededed}.header__toggle{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:44px;height:100%;background-color:transparent;padding-left:1.25rem}.header__toggle span{display:block;position:relative;margin-top:4px;background-color:#343851;width:100%;height:2px;border-radius:1px}.header__toggle span:first-child{margin-top:0}@media (min-width:62em){.header__toggle{display:none;visibility:hidden}.header__links{position:static;padding:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;visibility:visible;width:auto;height:100%}.header__links-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;padding:0}.header__link{position:relative;padding:.938rem 1rem;border:0;height:100%}.header__link::after{content:"";display:block;position:absolute;left:0;bottom:0;height:3px;width:100%;-webkit-transform:scaleX(0);transform:scaleX(0);background:#277cea}}.post-card{display:block;position:relative;width:100%;min-height:250px;border-radius:4px;overflow:hidden;background-color:#fff;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.08);box-shadow:0 1px 3px rgba(0,0,0,.08);margin-bottom:2.25rem;border-bottom:0}@media only screen and (min-width:48em){.post-card{width:48.4375%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:0}}@media only screen and (min-width:75em){.post-card{width:31.25%;margin-right:3.125%}.post-card:nth-child(2n+2){margin-right:3.125%}}.post-card__label{position:absolute;top:1.5rem;left:1.5rem;z-index:2}.post-card__inner{display:block;position:relative;padding:1.875rem 1.25rem .625rem;width:100%;color:#838c8d;border-bottom:0}.post-card__header{margin-bottom:.75rem}.post-card__meta{font-size:.875rem}.post-card__thumb{margin:0;background:#fff;position:relative;overflow:hidden}.post-card__thumb::after{content:"";display:block;height:0;width:100%;padding-bottom:56.25%}.post-card__thumb>*{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.label{padding:0 10px;margin-bottom:1rem;display:inline-block;line-height:20px;font-size:.75rem;text-transform:uppercase;letter-spacing:1px;color:rgba(255,255,255,.8);border:2px solid rgba(255,255,255,.5);border-radius:100px}.hero{margin:3.75rem auto 0;min-height:16.25rem;width:100%;position:relative;background-color:#dde5ea;background-repeat:no-repeat;background-position:50%;background-size:cover}@media only screen and (min-width:62em){.hero{margin:0 auto;height:36em}}.hero::before{position:absolute;display:block;content:"";top:0;left:0;width:100%;height:100%;background:rgba(52,56,81,.8)}.hero__wrap{position:absolute;margin:auto;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);text-align:center;color:rgba(255,255,255,.8);width:100%;max-width:90%;z-index:1}.hero__wrap .hero__title{font-size:1.8em;color:#fff}.blog{background-color:#f9f9f9}.post-list{padding-top:2.5em;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}@media only screen and (min-width:48em){.hero__wrap{max-width:40em}.hero__wrap .hero__title{padding:1rem 0;font-size:2.625em;line-height:3.125rem}.post-list{padding-top:5em}}</style><link rel="preload" href="/assets/css/main.css" as="style" onload="this.rel='stylesheet'"> <noscript><link rel="stylesheet" href="/assets/css/main.css"></noscript> <script type="text/javascript"> /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */ (function(w){"use strict";if(!w.loadCSS){w.loadCSS=function(){}} var rp=loadCSS.relpreload={};rp.support=(function(){var ret;try{ret=w.document.createElement("link").relList.supports("preload")}catch(e){ret=!1} return function(){return ret}})();rp.bindMediaToggle=function(link){var finalMedia=link.media||"all";function enableStylesheet(){link.media=finalMedia} if(link.addEventListener){link.addEventListener("load",enableStylesheet)}else if(link.attachEvent){link.attachEvent("onload",enableStylesheet)} setTimeout(function(){link.rel="stylesheet";link.media="only x"});setTimeout(enableStylesheet,3000)};rp.poly=function(){if(rp.support()){return} var links=w.document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var link=links[i];if(link.rel==="preload"&&link.getAttribute("as")==="style"&&!link.getAttribute("data-loadcss")){link.setAttribute("data-loadcss",!0);rp.bindMediaToggle(link)}}};if(!rp.support()){rp.poly();var run=w.setInterval(rp.poly,500);if(w.addEventListener){w.addEventListener("load",function(){rp.poly();w.clearInterval(run)})}else if(w.attachEvent){w.attachEvent("onload",function(){rp.poly();w.clearInterval(run)})}} if(typeof exports!=="undefined"){exports.loadCSS=loadCSS} else{w.loadCSS=loadCSS}}(typeof global!=="undefined"?global:this)) </script></head><body class="site"><header class="header" itemscope itemtype="http://schema.org/SiteNavigationElement" aria-label="Main navigation"><div class="container"><div class="header__inner"> <a class="header__logo" href="/"><div class="header__logo--container"> <?xml version="1.0" encoding="UTF-8"?> <svg width="38px" height="38px" viewBox="0 0 38 38" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <!-- Generator: Sketch 52.5 (67469) - http://www.bohemiancoding.com/sketch --><title>ComtravoLogo_square</title><desc>Created with Sketch.</desc> <g id="ComtravoLogo_square" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M35.6620561,4.04661309 L1.79462751,6.10975594 C1.07891322,6.15347023 0.740341792,7.00718452 1.23148465,7.53004166 L11.6894846,18.7020417 C11.9577704,18.9883274 12.3863418,19.0560417 12.7274846,18.8648988 L27.4540561,10.6166131 C27.8620561,10.3877559 28.0051989,9.87261309 27.7746275,9.46461309 C27.5431989,9.05661309 27.0254846,8.9108988 26.6174846,9.1388988 L12.4711989,17.0614702 L3.69748465,7.69032737 L34.5066275,5.81318452 L18.5166275,30.5074702 L18.0417704,19.9226131 C18.0203418,19.4537559 17.6329132,19.0911845 17.1769132,19.1126131 C16.7200561,19.1340417 16.3669132,19.5317559 16.3883418,20.0006131 L16.9797704,33.1783274 C17.0166275,33.9986131 18.0520561,34.2943274 18.4951989,33.6103274 L36.8200561,5.31175594 C37.0729132,4.9208988 36.9700561,4.39375594 36.5894846,4.13318452 C36.3520561,3.97118452 35.7186275,4.04318452 35.6620561,4.04661309 Z" id="Fill-1" fill="#00B4EA" transform="translate(18.979293, 19.009207) rotate(2.000000) translate(-18.979293, -19.009207) "></path> </g> </svg></div></a><nav class="header__links"><div class="container header__links-wrapper"> <a class="header__link" href="/" itemprop="url"> <span itemprop="name">Home</span> </a></div></nav><div class="header__toggle"> <span></span> <span></span> <span></span></div></div></div></header><div class="hero dark-bg"><div class="hero__wrap"><div class="hero__categories"> <a class="label" href="//categories/#JavaScript">JavaScript</a></div><h1 class="hero__title">Async/Await and JavaScript Arrays</h1><p class="hero__meta"> <span> <time>08 Jan 2019</time>&nbsp;&middot; </span> <span> ~ 18 mins read </span></p><p class="hero__meta">Ruwan Geeganagee - Senior Software Engineer</p></div></div><main class="site__content"><div class="container"><article class="post-content" itemprop="articleBody"><h1 id="asyncawait-for-javascript-array-methods">Async/Await for JavaScript Array methods</h1><p><a href="https://github.com/rpgeeganage/">Ruwan Geeganage</a></p><h3 id="senior-software-engineer-at-comtravo">Senior Software Engineer at Comtravo</h3><h2 id="asynchronous-code-and-comtravo-the-backend">Asynchronous Code and Comtravo the Backend</h2><p>The Comtravo backend is built from a number of micro-services, most of which run on Node.js. Like any large scale business application we need to do a lot of communication with internal as well as external API endpoints and services. In this post I will outline how using asynchrounous calls to perform that communication is often easier and produces cleaner syntax.</p><p>In general, asynchronous code is a formalism that allows non-blocking function calls. When a non-blocking function is called, the calling code receives a future (immediately) and can continue executing other commands instead of having to wait for the called task to finish, for instance waiting for network I/O to be completed. The future represents a promise that the called function will eventually complete (or fail). However, the actual return value of the called function is available only at some later point in time not immediately.</p><p>In JavaScript futures are implemented as a <code class="highlighter-rouge">Promise</code>. The native <code class="highlighter-rouge">Promise</code> API is rather limited. For instance, the only way to handle multiple <code class="highlighter-rouge">Promise</code>s at once is to use <code class="highlighter-rouge">Promise.all</code>. We make heavy use of asynchronous calls and <code class="highlighter-rouge">Promise</code>s at Comtravo and these limitations have become problematic. For instance, using a <code class="highlighter-rouge">Promise</code> returned from an asynchronous call as an array filter condition is not possible because the <code class="highlighter-rouge">Promise</code> object itself evaluates to true.</p><p>Previous iterations of asynchronous code in JavaScript utilised callbacks (<a href="https://caolan.github.io/async/">AsyncJS</a>). In this post I’ll explore some initial ideas on how to use async calls and promises on array operations.</p><h2 id="asynchronous-operations-and-javascript-arrays">Asynchronous Operations and JavaScript Arrays</h2><p>Consider a use case where we hold a list of IDs on the client side and need to filter the IDs based on the status of the objects on some remote service. Querying the remote service for the status requires network I/O and can’t therefore complete immediately. This is where the asynchrounous calls come in handy.</p><p>I started using Node.js v8.10.0 with Async/Await, but I could’t use Async/Await with Array methods such as <code class="highlighter-rouge">filter()</code>, <code class="highlighter-rouge">every()</code>, <code class="highlighter-rouge">find()</code>, <code class="highlighter-rouge">findIndex()</code>, <code class="highlighter-rouge">forEach()</code>, <code class="highlighter-rouge">map()</code>, <code class="highlighter-rouge">reduce()</code>, <code class="highlighter-rouge">reduceRight()</code> and <code class="highlighter-rouge">some()</code>. This post outlines how those functions could be modified to support asynchrounous calls. You can find a more thorough implementation of the ideas presented here in the Async-Ray library on <a href="https://github.com/rpgeeganage/async-ray">GitHub</a> or the <a href="https://www.npmjs.com/package/async-ray">NPM package</a>.</p><p>Let’s start with a simple example. Filtering a list of IDs in JavaScript is trivially easy when the filter function is syncrohonous</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">UIDs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">];</span> <span class="c1">// a long list of IDs to perform some operation on</span>
<span class="nx">UIDs</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">e</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">expensiveOperation</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">);</span>
</code></pre></div></div><h3 id="asynchronous-filtering">Asynchronous Filtering</h3><p>If we replace the filter function <code class="highlighter-rouge">(e) =&gt; e &gt; 2</code> with an async call the code will not work as expected (see below). As mentioned earlier the return value of the Async call is a <code class="highlighter-rouge">Promise</code> that evaluates to <code class="highlighter-rouge">true</code>, so nothing will ever be filtered as the filtering condition will always be true.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">UIDs</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kr">await</span> <span class="nx">asyncOp</span><span class="p">(</span><span class="nx">e</span><span class="p">)).</span><span class="nx">map</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">expensiveOperation</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">);</span>
</code></pre></div></div><p>In order to produce the intended behaviour we need to write some rather convoluted code and introduce an additional list to hold the filtered values.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">filteredList</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">e</span> <span class="k">of</span> <span class="nx">UIDs</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Call the async operation</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">await</span> <span class="nx">asyncOp</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">filteredList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="nx">filteredList</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">expensiveOperation</span><span class="p">(</span><span class="nx">e</span><span class="p">));</span>
</code></pre></div></div><p>With an imaginary <code class="highlighter-rouge">asyncFilter</code> that supports async/await we can make the above code much cleaner</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">mappedValues</span> <span class="o">=</span> <span class="p">(</span><span class="kr">await</span> <span class="nx">UIDs</span><span class="p">.</span><span class="nx">asyncFilter</span><span class="p">(</span> <span class="k">async</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="kr">await</span> <span class="nx">asyncOp</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">)</span>
    <span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">expensiveOperation</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span>
</code></pre></div></div><p>Of course that imaginary <code class="highlighter-rouge">Array.asyncFilter</code> does not in fact exist, but I thought of doing something like the example below. The filter function (<code class="highlighter-rouge">aFilter</code>) takes an array of values to be filtered and a callback and returns a promise. Please note that all the code snippets below are in <code class="highlighter-rouge">TypeScript</code>.</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Signature of the callback</span>
<span class="nx">type</span> <span class="nx">CallBackFilter</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async Filter function
 *
 * @export
 * @template T
 * @param {T[]} elements
 * @param {CallBackFilter&lt;T&gt;} cb
 * @returns {Promise&lt;T[]&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aFilter</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span>
  <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span>
  <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackFilter</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span>
<span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="na">filteredResults</span><span class="p">:</span> <span class="nx">T</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">]</span> <span class="k">of</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">filteredResults</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">filteredResults</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div><p>This can be used as follows with the same list of <code class="highlighter-rouge">UIDs</code> already used earlier</p><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aFilter</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">UIDs</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div><p>Below are example implementations for the other <code class="highlighter-rouge">Array</code> methods (<code class="highlighter-rouge">Array.every</code>, <code class="highlighter-rouge">Array.find</code> etc.). However, one issue still remains with these examples: chaining calls is quite cumbersome as the await calls still need to be wrapped in brackets. Luckily, there’s a solution for that as well. You can find the details in my <code class="highlighter-rouge">Async-Ray</code> library on <a href="https://github.com/rpgeeganage/async-ray">GitHub</a>.</p><h1 id="footnotes">Footnotes</h1><h2 id="arrayevery"><code class="highlighter-rouge">Array.every</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Signature of the callback</span>
<span class="nx">type</span> <span class="nx">CallBackEvery</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async Every function
 *
 * @export
 * @template T
 * @param {T[]} elements
 * @param {CallBackEvery&lt;T&gt;} cb
 * @returns {Promise&lt;boolean&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aEvery</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span> <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackEvery</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">]</span> <span class="k">of</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">)))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aEvery</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div><h2 id="arrayfind"><code class="highlighter-rouge">Array.find</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Signature of the callback</span>
<span class="nx">type</span> <span class="nx">CallBackFind</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async Find function
 *
 * @export
 * @template T
 * @param {T[]} elements
 * @param {CallBackFind&lt;T&gt;} cb
 * @returns {Promise&lt;T | undefined&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aFind</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span> <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackFind</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">|</span> <span class="kc">undefined</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">]</span> <span class="k">of</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">element</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aFind</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div><h2 id="arrayfindindex"><code class="highlighter-rouge">Array.findIndex</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Signature of the callback</span>
<span class="nx">type</span> <span class="nx">CallBackFindIndex</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async FindIndex function
 *
 * @export
 * @template T
 * @param {T[]} elements
 * @param {CallBackFind&lt;T&gt;} cb
 * @returns {Promise&lt;number&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aFindIndex</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span> <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackFindIndex</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">]</span> <span class="k">of</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">index</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aFindIndex</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">i</span> <span class="o">===</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div></div><h2 id="arrayforeach"><code class="highlighter-rouge">Array.forEach</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Signature of the callback</span>
<span class="nx">type</span> <span class="nx">CallBackForEach</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async ForEach function
 *
 * @export
 * @template T
 * @param {T[]} elements
 * @param {CallBackForEach&lt;T&gt;} cb
 * @returns {Promise&lt;void&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aForEach</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span> <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackForEach</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">]</span> <span class="k">of</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
    <span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="na">output</span><span class="p">:</span> <span class="nx">number</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>

<span class="kr">await</span> <span class="nx">aForEach</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">output</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div><h2 id="arraymap"><code class="highlighter-rouge">Array.map</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Signature of the callback</span>
<span class="nx">type</span> <span class="nx">CallBackMap</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">R</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async Map function
 *
 * @export
 * @template T
 * @template R
 * @param {T[]} elements
 * @param {CallBackMap&lt;T, R&gt;} cb
 * @returns {Promise&lt;R[]&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aMap</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span><span class="p">(</span>
  <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span>
  <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackMap</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span>
<span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">R</span><span class="p">[]</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="na">mappedResults</span><span class="p">:</span> <span class="nx">R</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">]</span> <span class="k">of</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">mappedResult</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">);</span>
    <span class="nx">mappedResults</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">mappedResult</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">mappedResults</span><span class="p">;</span>

<span class="p">}</span>


<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aMap</span><span class="o">&lt;</span><span class="nx">number</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span>
<span class="p">});</span>
</code></pre></div></div><h2 id="arrayreduce"><code class="highlighter-rouge">Array.reduce</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Signature of the callback</span>
<span class="nx">type</span> <span class="nx">CallBackReduce</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">accumulator</span><span class="p">:</span> <span class="nx">R</span><span class="p">,</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">R</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async Reduce function
 *
 * @export
 * @template T
 * @template R
 * @param {T[]} elements
 * @param {CallBackReduce&lt;T, R&gt;} cb
 * @param {R} [initialValue]
 * @returns {Promise&lt;R&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aReduce</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span><span class="p">(</span> <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackReduce</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">initialValue</span><span class="p">?:</span> <span class="nx">R</span> <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">|</span> <span class="nx">R</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">initialValue</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'Reduce of empty array with no initial value'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">let</span> <span class="na">reducedValue</span><span class="p">:</span> <span class="nx">T</span> <span class="o">|</span> <span class="nx">R</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">initialValue</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">reducedValue</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="nx">T</span><span class="p">;</span>
    <span class="nx">index</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">reducedValue</span> <span class="o">=</span> <span class="nx">initialValue</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(;</span> <span class="nx">index</span> <span class="o">&lt;</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">index</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">reducedValue</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">reducedValue</span><span class="p">,</span> <span class="nx">elements</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">reducedValue</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aReduce</span><span class="o">&lt;</span><span class="nx">number</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">i</span><span class="p">,)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s2">`</span><span class="p">${</span><span class="nx">acc</span><span class="p">}${</span><span class="nx">i</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">10</span><span class="p">)}</span><span class="s2">`</span><span class="p">);</span>
<span class="p">},</span> <span class="s1">''</span><span class="p">);</span>
</code></pre></div></div><h2 id="arrayreduceright"><code class="highlighter-rouge">Array.reduceRight</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/** returns any type value */</span>
<span class="nx">type</span> <span class="nx">CallBackReduceRight</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">accumulator</span><span class="p">:</span> <span class="nx">T</span> <span class="o">|</span> <span class="nx">R</span><span class="p">,</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">|</span> <span class="nx">R</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async ReduceRight function
 *
 * @export
 * @template T
 * @template R
 * @param {T[]} elements
 * @param {CallBackReduceRight&lt;T, R&gt;} cb
 * @param {R} [initialValue]
 * @returns {Promise&lt;T | R&gt;}
 */</span>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">aReduceRight</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span><span class="p">(</span> <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackReduceRight</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">,</span> <span class="nx">R</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">initialValue</span><span class="p">?:</span> <span class="nx">R</span> <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">T</span> <span class="o">|</span> <span class="nx">R</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">elements</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">initialValue</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">'Reduce of empty array with no initial value'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">let</span> <span class="na">reducedValue</span><span class="p">:</span> <span class="nx">T</span> <span class="o">|</span> <span class="nx">R</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">initialValue</span> <span class="o">===</span> <span class="kc">undefined</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">reducedValue</span> <span class="o">=</span> <span class="nx">elements</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="k">as</span> <span class="nx">T</span><span class="p">;</span>
    <span class="nx">index</span><span class="o">--</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">reducedValue</span> <span class="o">=</span> <span class="nx">initialValue</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(;</span> <span class="nx">index</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">index</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">reducedValue</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">reducedValue</span><span class="p">,</span> <span class="nx">elements</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">reducedValue</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aReduceRight</span><span class="o">&lt;</span><span class="nx">number</span><span class="p">,</span> <span class="nx">number</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">acc</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">collection</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">acc</span> <span class="o">+</span> <span class="p">(</span><span class="kr">await</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
  <span class="p">},</span> <span class="mi">1</span><span class="p">);</span>
</code></pre></div></div><h2 id="arraysome"><code class="highlighter-rouge">Array.some</code></h2><div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/** returns boolean */</span>
<span class="nx">type</span> <span class="nx">CallBackSome</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">(</span>
  <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span>
  <span class="nx">index</span><span class="p">?:</span> <span class="nx">number</span><span class="p">,</span>
  <span class="nx">collection</span><span class="p">?:</span> <span class="nx">T</span><span class="p">[]</span>
<span class="p">)</span> <span class="o">=&gt;</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span><span class="p">;</span>

<span class="cm">/**
 * Async Some function
 *
 * @export
 * @template T
 * @param {T[]} elements
 * @param {CallBackSome&lt;T&gt;} cb
 * @returns {Promise&lt;boolean&gt;}
 */</span>
<span class="k">export</span> <span class="k">async</span> <span class="kd">function</span> <span class="nx">some</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span> <span class="nx">elements</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">cb</span><span class="p">:</span> <span class="nx">CallBackSome</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="kr">boolean</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="p">[</span><span class="nx">index</span><span class="p">,</span> <span class="nx">element</span><span class="p">]</span> <span class="k">of</span> <span class="nx">elements</span><span class="p">.</span><span class="nx">entries</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Prawait</span> <span class="nx">cb</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">elements</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// You can use as follows</span>
<span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">];</span>

<span class="kd">const</span> <span class="nx">output</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">aSome</span><span class="o">&lt;</span><span class="nx">number</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
 <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div><p>The above methods are the ones I find feasible. As I mentioned earlier, all these methods are compiled into an NPM Package <code class="highlighter-rouge">Async-Ray</code>, please check it out on <a href="https://github.com/rpgeeganage/async-ray">GitHub</a> and feel free to contribute. The project is MIT licensed.</p></article><div class="post-content controls__inner"><div class="controls__item prev"> <span>Previous</span> <a href="/Neural-NER-Systems/"> <span> <svg xmlns="http://www.w3.org/2000/svg" width="6" height="11"><path fill="fillColor" d="M5.647 1.718c.37-.434.323-1.09-.106-1.465A1.016 1.016 0 0 0 4.095.36L.25 4.875a1.05 1.05 0 0 0 .017 1.378l3.95 4.407c.38.424 1.03.456 1.448.07a1.05 1.05 0 0 0 .07-1.468l-3.34-3.725 3.253-3.819z"/> </svg> </span> Named Entity Recognition us... </a></div><div class="controls__item next"></div></div></div></main><footer class="footer"><div class="container"><nav class="social"> <a class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/comtravo"> <svg class="social__icon" viewBox="0 0 20 20" width="20px" height="20px"><path d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg> </a> <a class="social__link" target="_blank" rel="noopener noreferrer" href="https://www.twitter.com/comtravo_travel"> <svg class="social__icon" viewBox="0 0 20 20" width="20px" height="20px"><path d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg> </a></nav><span>&copy; 2019 Comtravo tech. All rights reserved.</span></div></footer><script async src="/assets/js/bundle.js"></script> <script async> if ('serviceWorker' in navigator) { navigator.serviceWorker.register('/sw.js').then(function( registration ) { console.log('ServiceWorker registration successful with scope: ', registration.scope); }) .catch(function(error) { console.log('ServiceWorker registration failed: ', error); }); } </script></body></html>
